const form = document.querySelector('#myForm');
const sendBtn = document.querySelector('.checkin');
const emails = ['ivanov@mail.ru', 'petrov@yandex.ru', 'zuev@inbox.ru'];
const emailError = document.querySelector('.email__error');

form.addEventListener('submit', e => {
  e.preventDefault();

  const password = form.elements.password;
  const email = form.elements.email;
  const agreement = form.elements.agreement;

  if(password.value === '') {
    addFormMessage(password, 'Поле не может быть пустым')
  } else if (password.value.length<4) {
    addFormMessage(password, 'Пароль должен быть не менее 4 символов');
  }

  if(email.value === '') {
    addFormMessage(email, 'Поле не может быть пустым')
  } else if(!validateEmail(email.value)) {
    addFormMessage(email, 'Не корректный почтовый адрес')
  } 

  for(var i=0; i<emails.length; i++ ){
    if(email.value === emails[i]) {
      emailError.style.display='flex';
    }
  }
  
  if(!agreement.checked) {
    addFormMessage(agreement, 'Требуется подтверждение')
  }
});

// при фокусе на инпут убираем класс ошибки
[...form.elements].forEach((input) => {
  input.addEventListener('focus', e => {
    let elem = e.currentTarget.parentElement;

    let messElem = elem.querySelector('.form__error');
    if(messElem) {
      elem.removeChild(messElem);
    }

    elem.classList.remove('form__row_error');

    if(emailError) {
      emailError.style.display='none';
    }
  });
  
  agreement.addEventListener('change', e => {
    let elem = e.currentTarget.parentElement;

    let messElem = elem.querySelector('.form__error');
    if(messElem) {
      elem.removeChild(messElem);
    }

    elem.classList.remove('form__row_error');
  });
});

// добавляем (создаем) блок-сообщение об ошибке
function addFormMessage(elem, message) {
  let parrent = elem.parentElement;

  let messageContainer = document.createElement('div');
  messageContainer.classList.add('form__error');
  messageContainer.innerHTML = message;
  parrent.appendChild(messageContainer);

  parrent.classList.add('form__row_error');
}

// валидация email
function validateEmail(email) {
  var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
  return re.test(email);
}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZvcm0uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6Im1haW4ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNteUZvcm0nKTtcclxuY29uc3Qgc2VuZEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jaGVja2luJyk7XHJcbmNvbnN0IGVtYWlscyA9IFsnaXZhbm92QG1haWwucnUnLCAncGV0cm92QHlhbmRleC5ydScsICd6dWV2QGluYm94LnJ1J107XHJcbmNvbnN0IGVtYWlsRXJyb3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZW1haWxfX2Vycm9yJyk7XHJcblxyXG5mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGUgPT4ge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgY29uc3QgcGFzc3dvcmQgPSBmb3JtLmVsZW1lbnRzLnBhc3N3b3JkO1xyXG4gIGNvbnN0IGVtYWlsID0gZm9ybS5lbGVtZW50cy5lbWFpbDtcclxuICBjb25zdCBhZ3JlZW1lbnQgPSBmb3JtLmVsZW1lbnRzLmFncmVlbWVudDtcclxuXHJcbiAgaWYocGFzc3dvcmQudmFsdWUgPT09ICcnKSB7XHJcbiAgICBhZGRGb3JtTWVzc2FnZShwYXNzd29yZCwgJ9Cf0L7Qu9C1INC90LUg0LzQvtC20LXRgiDQsdGL0YLRjCDQv9GD0YHRgtGL0LwnKVxyXG4gIH0gZWxzZSBpZiAocGFzc3dvcmQudmFsdWUubGVuZ3RoPDQpIHtcclxuICAgIGFkZEZvcm1NZXNzYWdlKHBhc3N3b3JkLCAn0J/QsNGA0L7Qu9GMINC00L7Qu9C20LXQvSDQsdGL0YLRjCDQvdC1INC80LXQvdC10LUgNCDRgdC40LzQstC+0LvQvtCyJyk7XHJcbiAgfVxyXG5cclxuICBpZihlbWFpbC52YWx1ZSA9PT0gJycpIHtcclxuICAgIGFkZEZvcm1NZXNzYWdlKGVtYWlsLCAn0J/QvtC70LUg0L3QtSDQvNC+0LbQtdGCINCx0YvRgtGMINC/0YPRgdGC0YvQvCcpXHJcbiAgfSBlbHNlIGlmKCF2YWxpZGF0ZUVtYWlsKGVtYWlsLnZhbHVlKSkge1xyXG4gICAgYWRkRm9ybU1lc3NhZ2UoZW1haWwsICfQndC1INC60L7RgNGA0LXQutGC0L3Ri9C5INC/0L7Rh9GC0L7QstGL0Lkg0LDQtNGA0LXRgScpXHJcbiAgfSBcclxuXHJcbiAgZm9yKHZhciBpPTA7IGk8ZW1haWxzLmxlbmd0aDsgaSsrICl7XHJcbiAgICBpZihlbWFpbC52YWx1ZSA9PT0gZW1haWxzW2ldKSB7XHJcbiAgICAgIGVtYWlsRXJyb3Iuc3R5bGUuZGlzcGxheT0nZmxleCc7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIGlmKCFhZ3JlZW1lbnQuY2hlY2tlZCkge1xyXG4gICAgYWRkRm9ybU1lc3NhZ2UoYWdyZWVtZW50LCAn0KLRgNC10LHRg9C10YLRgdGPINC/0L7QtNGC0LLQtdGA0LbQtNC10L3QuNC1JylcclxuICB9XHJcbn0pO1xyXG5cclxuLy8g0L/RgNC4INGE0L7QutGD0YHQtSDQvdCwINC40L3Qv9GD0YIg0YPQsdC40YDQsNC10Lwg0LrQu9Cw0YHRgSDQvtGI0LjQsdC60LhcclxuWy4uLmZvcm0uZWxlbWVudHNdLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCBlID0+IHtcclxuICAgIGxldCBlbGVtID0gZS5jdXJyZW50VGFyZ2V0LnBhcmVudEVsZW1lbnQ7XHJcblxyXG4gICAgbGV0IG1lc3NFbGVtID0gZWxlbS5xdWVyeVNlbGVjdG9yKCcuZm9ybV9fZXJyb3InKTtcclxuICAgIGlmKG1lc3NFbGVtKSB7XHJcbiAgICAgIGVsZW0ucmVtb3ZlQ2hpbGQobWVzc0VsZW0pO1xyXG4gICAgfVxyXG5cclxuICAgIGVsZW0uY2xhc3NMaXN0LnJlbW92ZSgnZm9ybV9fcm93X2Vycm9yJyk7XHJcblxyXG4gICAgaWYoZW1haWxFcnJvcikge1xyXG4gICAgICBlbWFpbEVycm9yLnN0eWxlLmRpc3BsYXk9J25vbmUnO1xyXG4gICAgfVxyXG4gIH0pO1xyXG4gIFxyXG4gIGFncmVlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBlID0+IHtcclxuICAgIGxldCBlbGVtID0gZS5jdXJyZW50VGFyZ2V0LnBhcmVudEVsZW1lbnQ7XHJcblxyXG4gICAgbGV0IG1lc3NFbGVtID0gZWxlbS5xdWVyeVNlbGVjdG9yKCcuZm9ybV9fZXJyb3InKTtcclxuICAgIGlmKG1lc3NFbGVtKSB7XHJcbiAgICAgIGVsZW0ucmVtb3ZlQ2hpbGQobWVzc0VsZW0pO1xyXG4gICAgfVxyXG5cclxuICAgIGVsZW0uY2xhc3NMaXN0LnJlbW92ZSgnZm9ybV9fcm93X2Vycm9yJyk7XHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuLy8g0LTQvtCx0LDQstC70Y/QtdC8ICjRgdC+0LfQtNCw0LXQvCkg0LHQu9C+0Lot0YHQvtC+0LHRidC10L3QuNC1INC+0LEg0L7RiNC40LHQutC1XHJcbmZ1bmN0aW9uIGFkZEZvcm1NZXNzYWdlKGVsZW0sIG1lc3NhZ2UpIHtcclxuICBsZXQgcGFycmVudCA9IGVsZW0ucGFyZW50RWxlbWVudDtcclxuXHJcbiAgbGV0IG1lc3NhZ2VDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICBtZXNzYWdlQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2Zvcm1fX2Vycm9yJyk7XHJcbiAgbWVzc2FnZUNvbnRhaW5lci5pbm5lckhUTUwgPSBtZXNzYWdlO1xyXG4gIHBhcnJlbnQuYXBwZW5kQ2hpbGQobWVzc2FnZUNvbnRhaW5lcik7XHJcblxyXG4gIHBhcnJlbnQuY2xhc3NMaXN0LmFkZCgnZm9ybV9fcm93X2Vycm9yJyk7XHJcbn1cclxuXHJcbi8vINCy0LDQu9C40LTQsNGG0LjRjyBlbWFpbFxyXG5mdW5jdGlvbiB2YWxpZGF0ZUVtYWlsKGVtYWlsKSB7XHJcbiAgdmFyIHJlID0gL14oKFtePD4oKVtcXF1cXFxcLiw7Olxcc0BcXFwiXSsoXFwuW148PigpW1xcXVxcXFwuLDs6XFxzQFxcXCJdKykqKXwoXFxcIi4rXFxcIikpQCgoXFxbWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcXSl8KChbYS16QS1aXFwtMC05XStcXC4pK1thLXpBLVpdezIsfSkpJC87XHJcbiAgcmV0dXJuIHJlLnRlc3QoZW1haWwpO1xyXG59Il19
